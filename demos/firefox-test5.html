<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Firefox SVG feComposite Rendering Test 5</title>
  <meta name="viewport" content="user-scalable=no, width=device-width, initial-scale=1, maximum-scale=1">
</head>
<body style="background-image: url(./img/checker.png); margin:0; padding:0; text-align:center;">

<!-- Fails. Renders Cyan -->
<svg xmlns="http://www.w3.org/2000/svg" width="200" height="200" viewBox="0 0 200 200" style="margin:20px 10px;">
	<defs>
    <filter id="myfilter1" color-interpolation-filters="sRGB" filterUnits="userSpaceOnUse" primitiveUnits="userSpaceOnUse" x="0" y="0" width="768" height="512">
      <feFlood x="0" y="0" width="100%" height="100%" flood-color="#000000" flood-opacity="1.0" result="i1"/>
      <feFlood x="0" y="0" width="100%" height="100%" flood-color="#ff0000" flood-opacity="1.0" result="i2"/>
			<feComposite operator="arithmetic" k1="0" k2="-1" k3="1" k4="0.998" in="i1" in2="i2"/>
		</filter>
	</defs>
	<rect x="0" y="0" width="200" height="200" filter="url(#myfilter1)"/>
</svg>

<!-- Works. Renders White -->
<svg xmlns="http://www.w3.org/2000/svg" width="200" height="200" viewBox="0 0 200 200" style="margin:20px 10px;">
	<defs>
    <filter id="myfilter2" color-interpolation-filters="sRGB" filterUnits="userSpaceOnUse" primitiveUnits="userSpaceOnUse" x="0" y="0" width="768" height="512">
      <feFlood x="0" y="0" width="100%" height="100%" flood-color="#000000" flood-opacity="1.0" result="i1"/>
      <feFlood x="0" y="0" width="100%" height="100%" flood-color="#ff0000" flood-opacity="1.0" result="i2"/>
			<feComposite operator="arithmetic" k1="0" k2="-1" k3="1" k4="0.999" in="i1" in2="i2"/>
		</filter>
	</defs>
	<rect x="0" y="0" width="200" height="200" filter="url(#myfilter2)"/>
</svg>

</body>
</html>